<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="author" content="Eric Archer" />

<meta name="date" content="2015-07-29" />

<title></title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; }
code > span.dt { color: #902000; }
code > span.dv { color: #40a070; }
code > span.bn { color: #40a070; }
code > span.fl { color: #40a070; }
code > span.ch { color: #4070a0; }
code > span.st { color: #4070a0; }
code > span.co { color: #60a0b0; font-style: italic; }
code > span.ot { color: #007020; }
code > span.al { color: #ff0000; font-weight: bold; }
code > span.fu { color: #06287e; }
code > span.er { color: #ff0000; font-weight: bold; }
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<link href="data:text/css,body%20%7B%0A%20%20background%2Dcolor%3A%20%23fff%3B%0A%20%20margin%3A%201em%20auto%3B%0A%20%20max%2Dwidth%3A%20700px%3B%0A%20%20overflow%3A%20visible%3B%0A%20%20padding%2Dleft%3A%202em%3B%0A%20%20padding%2Dright%3A%202em%3B%0A%20%20font%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0A%20%20font%2Dsize%3A%2014px%3B%0A%20%20line%2Dheight%3A%201%2E35%3B%0A%7D%0A%0A%23header%20%7B%0A%20%20text%2Dalign%3A%20center%3B%0A%7D%0A%0A%23TOC%20%7B%0A%20%20clear%3A%20both%3B%0A%20%20margin%3A%200%200%2010px%2010px%3B%0A%20%20padding%3A%204px%3B%0A%20%20width%3A%20400px%3B%0A%20%20border%3A%201px%20solid%20%23CCCCCC%3B%0A%20%20border%2Dradius%3A%205px%3B%0A%0A%20%20background%2Dcolor%3A%20%23f6f6f6%3B%0A%20%20font%2Dsize%3A%2013px%3B%0A%20%20line%2Dheight%3A%201%2E3%3B%0A%7D%0A%20%20%23TOC%20%2Etoctitle%20%7B%0A%20%20%20%20font%2Dweight%3A%20bold%3B%0A%20%20%20%20font%2Dsize%3A%2015px%3B%0A%20%20%20%20margin%2Dleft%3A%205px%3B%0A%20%20%7D%0A%0A%20%20%23TOC%20ul%20%7B%0A%20%20%20%20padding%2Dleft%3A%2040px%3B%0A%20%20%20%20margin%2Dleft%3A%20%2D1%2E5em%3B%0A%20%20%20%20margin%2Dtop%3A%205px%3B%0A%20%20%20%20margin%2Dbottom%3A%205px%3B%0A%20%20%7D%0A%20%20%23TOC%20ul%20ul%20%7B%0A%20%20%20%20margin%2Dleft%3A%20%2D2em%3B%0A%20%20%7D%0A%20%20%23TOC%20li%20%7B%0A%20%20%20%20line%2Dheight%3A%2016px%3B%0A%20%20%7D%0A%0Atable%20%7B%0A%20%20margin%3A%201em%20auto%3B%0A%20%20border%2Dwidth%3A%201px%3B%0A%20%20border%2Dcolor%3A%20%23DDDDDD%3B%0A%20%20border%2Dstyle%3A%20outset%3B%0A%20%20border%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0A%20%20border%2Dwidth%3A%202px%3B%0A%20%20padding%3A%205px%3B%0A%20%20border%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0A%20%20border%2Dwidth%3A%201px%3B%0A%20%20border%2Dstyle%3A%20inset%3B%0A%20%20line%2Dheight%3A%2018px%3B%0A%20%20padding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0A%20%20border%2Dleft%2Dstyle%3A%20none%3B%0A%20%20border%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0A%20%20background%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0A%0Ap%20%7B%0A%20%20margin%3A%200%2E5em%200%3B%0A%7D%0A%0Ablockquote%20%7B%0A%20%20background%2Dcolor%3A%20%23f6f6f6%3B%0A%20%20padding%3A%200%2E25em%200%2E75em%3B%0A%7D%0A%0Ahr%20%7B%0A%20%20border%2Dstyle%3A%20solid%3B%0A%20%20border%3A%20none%3B%0A%20%20border%2Dtop%3A%201px%20solid%20%23777%3B%0A%20%20margin%3A%2028px%200%3B%0A%7D%0A%0Adl%20%7B%0A%20%20margin%2Dleft%3A%200%3B%0A%7D%0A%20%20dl%20dd%20%7B%0A%20%20%20%20margin%2Dbottom%3A%2013px%3B%0A%20%20%20%20margin%2Dleft%3A%2013px%3B%0A%20%20%7D%0A%20%20dl%20dt%20%7B%0A%20%20%20%20font%2Dweight%3A%20bold%3B%0A%20%20%7D%0A%0Aul%20%7B%0A%20%20margin%2Dtop%3A%200%3B%0A%7D%0A%20%20ul%20li%20%7B%0A%20%20%20%20list%2Dstyle%3A%20circle%20outside%3B%0A%20%20%7D%0A%20%20ul%20ul%20%7B%0A%20%20%20%20margin%2Dbottom%3A%200%3B%0A%20%20%7D%0A%0Apre%2C%20code%20%7B%0A%20%20background%2Dcolor%3A%20%23f7f7f7%3B%0A%20%20border%2Dradius%3A%203px%3B%0A%20%20color%3A%20%23333%3B%0A%7D%0Apre%20%7B%0A%20%20white%2Dspace%3A%20pre%2Dwrap%3B%20%20%20%20%2F%2A%20Wrap%20long%20lines%20%2A%2F%0A%20%20border%2Dradius%3A%203px%3B%0A%20%20margin%3A%205px%200px%2010px%200px%3B%0A%20%20padding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0A%20%20background%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0A%0Acode%20%7B%0A%20%20font%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0A%20%20font%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0A%20%20padding%3A%202px%200px%3B%0A%7D%0A%0Adiv%2Efigure%20%7B%0A%20%20text%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0A%20%20background%2Dcolor%3A%20%23FFFFFF%3B%0A%20%20padding%3A%202px%3B%0A%20%20border%3A%201px%20solid%20%23DDDDDD%3B%0A%20%20border%2Dradius%3A%203px%3B%0A%20%20border%3A%201px%20solid%20%23CCCCCC%3B%0A%20%20margin%3A%200%205px%3B%0A%7D%0A%0Ah1%20%7B%0A%20%20margin%2Dtop%3A%200%3B%0A%20%20font%2Dsize%3A%2035px%3B%0A%20%20line%2Dheight%3A%2040px%3B%0A%7D%0A%0Ah2%20%7B%0A%20%20border%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0A%20%20padding%2Dtop%3A%2010px%3B%0A%20%20padding%2Dbottom%3A%202px%3B%0A%20%20font%2Dsize%3A%20145%25%3B%0A%7D%0A%0Ah3%20%7B%0A%20%20border%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0A%20%20padding%2Dtop%3A%2010px%3B%0A%20%20font%2Dsize%3A%20120%25%3B%0A%7D%0A%0Ah4%20%7B%0A%20%20border%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0A%20%20margin%2Dleft%3A%208px%3B%0A%20%20font%2Dsize%3A%20105%25%3B%0A%7D%0A%0Ah5%2C%20h6%20%7B%0A%20%20border%2Dbottom%3A%201px%20solid%20%23ccc%3B%0A%20%20font%2Dsize%3A%20105%25%3B%0A%7D%0A%0Aa%20%7B%0A%20%20color%3A%20%230033dd%3B%0A%20%20text%2Ddecoration%3A%20none%3B%0A%7D%0A%20%20a%3Ahover%20%7B%0A%20%20%20%20color%3A%20%236666ff%3B%20%7D%0A%20%20a%3Avisited%20%7B%0A%20%20%20%20color%3A%20%23800080%3B%20%7D%0A%20%20a%3Avisited%3Ahover%20%7B%0A%20%20%20%20color%3A%20%23BB00BB%3B%20%7D%0A%20%20a%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0A%20%20%20%20text%2Ddecoration%3A%20underline%3B%20%7D%0A%20%20a%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0A%20%20%20%20text%2Ddecoration%3A%20underline%3B%20%7D%0A%0A%2F%2A%20Class%20described%20in%20https%3A%2F%2Fbenjeffrey%2Ecom%2Fposts%2Fpandoc%2Dsyntax%2Dhighlighting%2Dcss%0A%20%20%20Colours%20from%20https%3A%2F%2Fgist%2Egithub%2Ecom%2Frobsimmons%2F1172277%20%2A%2F%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%2F%2A%20Keyword%20%2A%2F%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%2F%2A%20DataType%20%2A%2F%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%2F%2A%20DecVal%20%28decimal%20values%29%20%2A%2F%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20BaseN%20%2A%2F%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20Float%20%2A%2F%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20Char%20%2A%2F%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20String%20%2A%2F%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%2F%2A%20Comment%20%2A%2F%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%2F%2A%20OtherToken%20%2A%2F%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%2F%2A%20AlertToken%20%2A%2F%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%2F%2A%20Function%20calls%20%2A%2F%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%2F%2A%20ErrorTok%20%2A%2F%0A%0A" rel="stylesheet" type="text/css" />

</head>

<body>



<div id="header">
<h1 class="title"><ol start="3" style="list-style-type: decimal">
<li>Working With Sequences</li>
</ol></h1>
<h4 class="author"><em>Eric Archer</em></h4>
<h4 class="date"><em>2015-07-29</em></h4>
</div>


<p>There are several functions for working with sequence data in strataG. They will either take a haploid <em>gtypes</em> object that contains sequences or some format that can be converted to a <em>DNAbin</em> (in the <em>ape</em> package), or <em>multidna</em> (in the <em>apex</em> package) object.</p>
<p>Leading and trailing N’s can be removed from all sequences like this:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(strataGdevel)
<span class="kw">data</span>(dolph.seqs)

i &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span>:<span class="dv">10</span>, <span class="dv">1</span>)
j &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span>:<span class="dv">10</span>, <span class="dv">1</span>)
x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;n&quot;</span>, i), dolph.seqs[[<span class="dv">1</span>]], <span class="kw">rep</span>(<span class="st">&quot;n&quot;</span>, j))
x</code></pre>
<pre><code>##   [1] &quot;n&quot; &quot;n&quot; &quot;n&quot; &quot;n&quot; &quot;g&quot; &quot;a&quot; &quot;a&quot; &quot;a&quot; &quot;a&quot; &quot;a&quot; &quot;-&quot; &quot;g&quot; &quot;c&quot; &quot;t&quot; &quot;t&quot; &quot;a&quot; &quot;t&quot;
##  [18] &quot;t&quot; &quot;g&quot; &quot;t&quot; &quot;a&quot; &quot;c&quot; &quot;a&quot; &quot;g&quot; &quot;t&quot; &quot;t&quot; &quot;a&quot; &quot;c&quot; &quot;c&quot; &quot;a&quot; &quot;c&quot; &quot;a&quot; &quot;a&quot; &quot;c&quot;
##  [35] &quot;a&quot; &quot;t&quot; &quot;c&quot; &quot;a&quot; &quot;c&quot; &quot;a&quot; &quot;g&quot; &quot;t&quot; &quot;a&quot; &quot;c&quot; &quot;t&quot; &quot;a&quot; &quot;c&quot; &quot;g&quot; &quot;t&quot; &quot;c&quot; &quot;a&quot;
##  [52] &quot;g&quot; &quot;t&quot; &quot;a&quot; &quot;t&quot; &quot;t&quot; &quot;a&quot; &quot;a&quot; &quot;a&quot; &quot;a&quot; &quot;g&quot; &quot;t&quot; &quot;a&quot; &quot;a&quot; &quot;t&quot; &quot;t&quot; &quot;t&quot; &quot;g&quot;
##  [69] &quot;t&quot; &quot;t&quot; &quot;t&quot; &quot;t&quot; &quot;a&quot; &quot;a&quot; &quot;a&quot; &quot;a&quot; &quot;a&quot; &quot;c&quot; &quot;a&quot; &quot;t&quot; &quot;t&quot; &quot;t&quot; &quot;t&quot; &quot;a&quot; &quot;c&quot;
##  [86] &quot;t&quot; &quot;g&quot; &quot;t&quot; &quot;a&quot; &quot;c&quot; &quot;a&quot; &quot;c&quot; &quot;a&quot; &quot;t&quot; &quot;t&quot; &quot;a&quot; &quot;c&quot; &quot;a&quot; &quot;t&quot; &quot;a&quot; &quot;t&quot; &quot;a&quot;
## [103] &quot;c&quot; &quot;a&quot; &quot;t&quot; &quot;a&quot; &quot;c&quot; &quot;a&quot; &quot;c&quot; &quot;a&quot; &quot;t&quot; &quot;g&quot; &quot;t&quot; &quot;g&quot; &quot;c&quot; &quot;a&quot; &quot;t&quot; &quot;g&quot; &quot;c&quot;
## [120] &quot;t&quot; &quot;a&quot; &quot;a&quot; &quot;t&quot; &quot;a&quot; &quot;t&quot; &quot;t&quot; &quot;t&quot; &quot;a&quot; &quot;g&quot; &quot;t&quot; &quot;c&quot; &quot;-&quot; &quot;t&quot; &quot;c&quot; &quot;t&quot; &quot;c&quot;
## [137] &quot;c&quot; &quot;t&quot; &quot;t&quot; &quot;g&quot; &quot;t&quot; &quot;a&quot; &quot;a&quot; &quot;a&quot; &quot;t&quot; &quot;a&quot; &quot;t&quot; &quot;t&quot; &quot;c&quot; &quot;a&quot; &quot;t&quot; &quot;a&quot; &quot;c&quot;
## [154] &quot;a&quot; &quot;t&quot; &quot;a&quot; &quot;c&quot; &quot;a&quot; &quot;t&quot; &quot;g&quot; &quot;c&quot; &quot;t&quot; &quot;a&quot; &quot;t&quot; &quot;g&quot; &quot;t&quot; &quot;a&quot; &quot;t&quot; &quot;t&quot; &quot;a&quot;
## [171] &quot;t&quot; &quot;t&quot; &quot;g&quot; &quot;t&quot; &quot;g&quot; &quot;c&quot; &quot;a&quot; &quot;t&quot; &quot;t&quot; &quot;c&quot; &quot;a&quot; &quot;t&quot; &quot;t&quot; &quot;t&quot; &quot;a&quot; &quot;t&quot; &quot;t&quot;
## [188] &quot;t&quot; &quot;t&quot; &quot;c&quot; &quot;c&quot; &quot;a&quot; &quot;t&quot; &quot;a&quot; &quot;c&quot; &quot;g&quot; &quot;a&quot; &quot;t&quot; &quot;a&quot; &quot;a&quot; &quot;g&quot; &quot;t&quot; &quot;t&quot; &quot;a&quot;
## [205] &quot;a&quot; &quot;a&quot; &quot;g&quot; &quot;c&quot; &quot;c&quot; &quot;c&quot; &quot;g&quot; &quot;t&quot; &quot;a&quot; &quot;t&quot; &quot;t&quot; &quot;a&quot; &quot;a&quot; &quot;t&quot; &quot;t&quot; &quot;a&quot; &quot;t&quot;
## [222] &quot;c&quot; &quot;a&quot; &quot;t&quot; &quot;t&quot; &quot;a&quot; &quot;a&quot; &quot;t&quot; &quot;t&quot; &quot;t&quot; &quot;t&quot; &quot;a&quot; &quot;c&quot; &quot;a&quot; &quot;t&quot; &quot;a&quot; &quot;t&quot; &quot;t&quot;
## [239] &quot;a&quot; &quot;c&quot; &quot;a&quot; &quot;t&quot; &quot;a&quot; &quot;a&quot; &quot;t&quot; &quot;a&quot; &quot;t&quot; &quot;g&quot; &quot;c&quot; &quot;a&quot; &quot;t&quot; &quot;g&quot; &quot;c&quot; &quot;t&quot; &quot;c&quot;
## [256] &quot;t&quot; &quot;t&quot; &quot;a&quot; &quot;c&quot; &quot;a&quot; &quot;t&quot; &quot;a&quot; &quot;t&quot; &quot;t&quot; &quot;a&quot; &quot;t&quot; &quot;a&quot; &quot;t&quot; &quot;c&quot; &quot;t&quot; &quot;c&quot; &quot;c&quot;
## [273] &quot;c&quot; &quot;c&quot; &quot;t&quot; &quot;a&quot; &quot;t&quot; &quot;c&quot; &quot;a&quot; &quot;a&quot; &quot;t&quot; &quot;t&quot; &quot;t&quot; &quot;c&quot; &quot;a&quot; &quot;c&quot; &quot;c&quot; &quot;t&quot; &quot;c&quot;
## [290] &quot;c&quot; &quot;a&quot; &quot;t&quot; &quot;t&quot; &quot;a&quot; &quot;t&quot; &quot;a&quot; &quot;c&quot; &quot;c&quot; &quot;c&quot; &quot;t&quot; &quot;a&quot; &quot;t&quot; &quot;g&quot; &quot;g&quot; &quot;t&quot; &quot;c&quot;
## [307] &quot;a&quot; &quot;c&quot; &quot;t&quot; &quot;c&quot; &quot;c&quot; &quot;a&quot; &quot;t&quot; &quot;t&quot; &quot;a&quot; &quot;g&quot; &quot;a&quot; &quot;t&quot; &quot;c&quot; &quot;a&quot; &quot;c&quot; &quot;g&quot; &quot;a&quot;
## [324] &quot;g&quot; &quot;c&quot; &quot;t&quot; &quot;t&quot; &quot;a&quot; &quot;a&quot; &quot;t&quot; &quot;c&quot; &quot;a&quot; &quot;c&quot; &quot;c&quot; &quot;a&quot; &quot;t&quot; &quot;g&quot; &quot;c&quot; &quot;c&quot; &quot;g&quot;
## [341] &quot;c&quot; &quot;g&quot; &quot;t&quot; &quot;g&quot; &quot;a&quot; &quot;a&quot; &quot;a&quot; &quot;c&quot; &quot;c&quot; &quot;a&quot; &quot;g&quot; &quot;c&quot; &quot;a&quot; &quot;a&quot; &quot;c&quot; &quot;c&quot; &quot;c&quot;
## [358] &quot;g&quot; &quot;c&quot; &quot;t&quot; &quot;c&quot; &quot;g&quot; &quot;g&quot; &quot;c&quot; &quot;a&quot; &quot;g&quot; &quot;g&quot; &quot;g&quot; &quot;a&quot; &quot;t&quot; &quot;c&quot; &quot;c&quot; &quot;c&quot; &quot;t&quot;
## [375] &quot;c&quot; &quot;t&quot; &quot;t&quot; &quot;c&quot; &quot;t&quot; &quot;c&quot; &quot;g&quot; &quot;c&quot; &quot;a&quot; &quot;c&quot; &quot;c&quot; &quot;g&quot; &quot;g&quot; &quot;g&quot; &quot;c&quot; &quot;c&quot; &quot;c&quot;
## [392] &quot;a&quot; &quot;t&quot; &quot;a&quot; &quot;t&quot; &quot;c&quot; &quot;t&quot; &quot;c&quot; &quot;g&quot; &quot;t&quot; &quot;g&quot; &quot;g&quot; &quot;g&quot; &quot;g&quot; &quot;g&quot; &quot;t&quot; &quot;n&quot; &quot;n&quot;
## [409] &quot;n&quot; &quot;n&quot;</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">x.trimmed &lt;-<span class="st"> </span><span class="kw">trimNs</span>(<span class="kw">as.DNAbin</span>(x))
<span class="kw">as.character</span>(<span class="kw">as.list</span>(x.trimmed))</code></pre>
<pre><code>## [[1]]
##   [1] &quot;g&quot; &quot;a&quot; &quot;a&quot; &quot;a&quot; &quot;a&quot; &quot;a&quot; &quot;-&quot; &quot;g&quot; &quot;c&quot; &quot;t&quot; &quot;t&quot; &quot;a&quot; &quot;t&quot; &quot;t&quot; &quot;g&quot; &quot;t&quot; &quot;a&quot;
##  [18] &quot;c&quot; &quot;a&quot; &quot;g&quot; &quot;t&quot; &quot;t&quot; &quot;a&quot; &quot;c&quot; &quot;c&quot; &quot;a&quot; &quot;c&quot; &quot;a&quot; &quot;a&quot; &quot;c&quot; &quot;a&quot; &quot;t&quot; &quot;c&quot; &quot;a&quot;
##  [35] &quot;c&quot; &quot;a&quot; &quot;g&quot; &quot;t&quot; &quot;a&quot; &quot;c&quot; &quot;t&quot; &quot;a&quot; &quot;c&quot; &quot;g&quot; &quot;t&quot; &quot;c&quot; &quot;a&quot; &quot;g&quot; &quot;t&quot; &quot;a&quot; &quot;t&quot;
##  [52] &quot;t&quot; &quot;a&quot; &quot;a&quot; &quot;a&quot; &quot;a&quot; &quot;g&quot; &quot;t&quot; &quot;a&quot; &quot;a&quot; &quot;t&quot; &quot;t&quot; &quot;t&quot; &quot;g&quot; &quot;t&quot; &quot;t&quot; &quot;t&quot; &quot;t&quot;
##  [69] &quot;a&quot; &quot;a&quot; &quot;a&quot; &quot;a&quot; &quot;a&quot; &quot;c&quot; &quot;a&quot; &quot;t&quot; &quot;t&quot; &quot;t&quot; &quot;t&quot; &quot;a&quot; &quot;c&quot; &quot;t&quot; &quot;g&quot; &quot;t&quot; &quot;a&quot;
##  [86] &quot;c&quot; &quot;a&quot; &quot;c&quot; &quot;a&quot; &quot;t&quot; &quot;t&quot; &quot;a&quot; &quot;c&quot; &quot;a&quot; &quot;t&quot; &quot;a&quot; &quot;t&quot; &quot;a&quot; &quot;c&quot; &quot;a&quot; &quot;t&quot; &quot;a&quot;
## [103] &quot;c&quot; &quot;a&quot; &quot;c&quot; &quot;a&quot; &quot;t&quot; &quot;g&quot; &quot;t&quot; &quot;g&quot; &quot;c&quot; &quot;a&quot; &quot;t&quot; &quot;g&quot; &quot;c&quot; &quot;t&quot; &quot;a&quot; &quot;a&quot; &quot;t&quot;
## [120] &quot;a&quot; &quot;t&quot; &quot;t&quot; &quot;t&quot; &quot;a&quot; &quot;g&quot; &quot;t&quot; &quot;c&quot; &quot;-&quot; &quot;t&quot; &quot;c&quot; &quot;t&quot; &quot;c&quot; &quot;c&quot; &quot;t&quot; &quot;t&quot; &quot;g&quot;
## [137] &quot;t&quot; &quot;a&quot; &quot;a&quot; &quot;a&quot; &quot;t&quot; &quot;a&quot; &quot;t&quot; &quot;t&quot; &quot;c&quot; &quot;a&quot; &quot;t&quot; &quot;a&quot; &quot;c&quot; &quot;a&quot; &quot;t&quot; &quot;a&quot; &quot;c&quot;
## [154] &quot;a&quot; &quot;t&quot; &quot;g&quot; &quot;c&quot; &quot;t&quot; &quot;a&quot; &quot;t&quot; &quot;g&quot; &quot;t&quot; &quot;a&quot; &quot;t&quot; &quot;t&quot; &quot;a&quot; &quot;t&quot; &quot;t&quot; &quot;g&quot; &quot;t&quot;
## [171] &quot;g&quot; &quot;c&quot; &quot;a&quot; &quot;t&quot; &quot;t&quot; &quot;c&quot; &quot;a&quot; &quot;t&quot; &quot;t&quot; &quot;t&quot; &quot;a&quot; &quot;t&quot; &quot;t&quot; &quot;t&quot; &quot;t&quot; &quot;c&quot; &quot;c&quot;
## [188] &quot;a&quot; &quot;t&quot; &quot;a&quot; &quot;c&quot; &quot;g&quot; &quot;a&quot; &quot;t&quot; &quot;a&quot; &quot;a&quot; &quot;g&quot; &quot;t&quot; &quot;t&quot; &quot;a&quot; &quot;a&quot; &quot;a&quot; &quot;g&quot; &quot;c&quot;
## [205] &quot;c&quot; &quot;c&quot; &quot;g&quot; &quot;t&quot; &quot;a&quot; &quot;t&quot; &quot;t&quot; &quot;a&quot; &quot;a&quot; &quot;t&quot; &quot;t&quot; &quot;a&quot; &quot;t&quot; &quot;c&quot; &quot;a&quot; &quot;t&quot; &quot;t&quot;
## [222] &quot;a&quot; &quot;a&quot; &quot;t&quot; &quot;t&quot; &quot;t&quot; &quot;t&quot; &quot;a&quot; &quot;c&quot; &quot;a&quot; &quot;t&quot; &quot;a&quot; &quot;t&quot; &quot;t&quot; &quot;a&quot; &quot;c&quot; &quot;a&quot; &quot;t&quot;
## [239] &quot;a&quot; &quot;a&quot; &quot;t&quot; &quot;a&quot; &quot;t&quot; &quot;g&quot; &quot;c&quot; &quot;a&quot; &quot;t&quot; &quot;g&quot; &quot;c&quot; &quot;t&quot; &quot;c&quot; &quot;t&quot; &quot;t&quot; &quot;a&quot; &quot;c&quot;
## [256] &quot;a&quot; &quot;t&quot; &quot;a&quot; &quot;t&quot; &quot;t&quot; &quot;a&quot; &quot;t&quot; &quot;a&quot; &quot;t&quot; &quot;c&quot; &quot;t&quot; &quot;c&quot; &quot;c&quot; &quot;c&quot; &quot;c&quot; &quot;t&quot; &quot;a&quot;
## [273] &quot;t&quot; &quot;c&quot; &quot;a&quot; &quot;a&quot; &quot;t&quot; &quot;t&quot; &quot;t&quot; &quot;c&quot; &quot;a&quot; &quot;c&quot; &quot;c&quot; &quot;t&quot; &quot;c&quot; &quot;c&quot; &quot;a&quot; &quot;t&quot; &quot;t&quot;
## [290] &quot;a&quot; &quot;t&quot; &quot;a&quot; &quot;c&quot; &quot;c&quot; &quot;c&quot; &quot;t&quot; &quot;a&quot; &quot;t&quot; &quot;g&quot; &quot;g&quot; &quot;t&quot; &quot;c&quot; &quot;a&quot; &quot;c&quot; &quot;t&quot; &quot;c&quot;
## [307] &quot;c&quot; &quot;a&quot; &quot;t&quot; &quot;t&quot; &quot;a&quot; &quot;g&quot; &quot;a&quot; &quot;t&quot; &quot;c&quot; &quot;a&quot; &quot;c&quot; &quot;g&quot; &quot;a&quot; &quot;g&quot; &quot;c&quot; &quot;t&quot; &quot;t&quot;
## [324] &quot;a&quot; &quot;a&quot; &quot;t&quot; &quot;c&quot; &quot;a&quot; &quot;c&quot; &quot;c&quot; &quot;a&quot; &quot;t&quot; &quot;g&quot; &quot;c&quot; &quot;c&quot; &quot;g&quot; &quot;c&quot; &quot;g&quot; &quot;t&quot; &quot;g&quot;
## [341] &quot;a&quot; &quot;a&quot; &quot;a&quot; &quot;c&quot; &quot;c&quot; &quot;a&quot; &quot;g&quot; &quot;c&quot; &quot;a&quot; &quot;a&quot; &quot;c&quot; &quot;c&quot; &quot;c&quot; &quot;g&quot; &quot;c&quot; &quot;t&quot; &quot;c&quot;
## [358] &quot;g&quot; &quot;g&quot; &quot;c&quot; &quot;a&quot; &quot;g&quot; &quot;g&quot; &quot;g&quot; &quot;a&quot; &quot;t&quot; &quot;c&quot; &quot;c&quot; &quot;c&quot; &quot;t&quot; &quot;c&quot; &quot;t&quot; &quot;t&quot; &quot;c&quot;
## [375] &quot;t&quot; &quot;c&quot; &quot;g&quot; &quot;c&quot; &quot;a&quot; &quot;c&quot; &quot;c&quot; &quot;g&quot; &quot;g&quot; &quot;g&quot; &quot;c&quot; &quot;c&quot; &quot;c&quot; &quot;a&quot; &quot;t&quot; &quot;a&quot; &quot;t&quot;
## [392] &quot;c&quot; &quot;t&quot; &quot;c&quot; &quot;g&quot; &quot;t&quot; &quot;g&quot; &quot;g&quot; &quot;g&quot; &quot;g&quot; &quot;g&quot; &quot;t&quot;</code></pre>
<p>Base frequencies for a sequence are calculated with the <em>baseFreqs</em> function:</p>
<pre class="sourceCode r"><code class="sourceCode r">bf &lt;-<span class="st"> </span><span class="kw">baseFreqs</span>(dolph.seqs)
bf$site.freqs[, <span class="dv">1</span>:<span class="dv">8</span>]</code></pre>
<pre><code>##     1   2   3   4   5   6 7   8
## a   0 126 126 126 126 126 5   0
## c   0   0   0   0   0   0 0   0
## g 126   0   0   0   0   0 0 126
## t   0   0   0   0   0   0 0   0
## u   0   0   0   0   0   0 0   0
## r   0   0   0   0   0   0 0   0
## y   0   0   0   0   0   0 0   0
## m   0   0   0   0   0   0 0   0
## k   0   0   0   0   0   0 0   0
## w   0   0   0   0   0   0 0   0
## s   0   0   0   0   0   0 0   0
## b   0   0   0   0   0   0 0   0
## d   0   0   0   0   0   0 0   0
## h   0   0   0   0   0   0 0   0
## v   0   0   0   0   0   0 0   0
## n   0   0   0   0   0   0 0   0
## x   0   0   0   0   0   0 0   0
## -   0   0   0   0   0   0 0   0
## .   0   0   0   0   0   0 0   0</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">bf$base.freqs</code></pre>
<pre><code>## 
##      a      c      g      t      u      r      y      m      k      w 
## 0.2997 0.2282 0.1283 0.3389 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 
##      s      b      d      h      v      n      x      -      . 
## 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0048 0.0000</code></pre>
<p>One can also identify which sites are fixed and which are variable:</p>
<pre class="sourceCode r"><code class="sourceCode r">fs &lt;-<span class="st"> </span><span class="kw">fixedSites</span>(dolph.seqs)
fs[<span class="dv">1</span>:<span class="dv">20</span>]</code></pre>
<pre><code>##   1   2   3   4   5   6   8   9  10  11  12  13  14  15  16  17  18  19 
## &quot;g&quot; &quot;a&quot; &quot;a&quot; &quot;a&quot; &quot;a&quot; &quot;a&quot; &quot;g&quot; &quot;c&quot; &quot;t&quot; &quot;t&quot; &quot;a&quot; &quot;t&quot; &quot;t&quot; &quot;g&quot; &quot;t&quot; &quot;a&quot; &quot;c&quot; &quot;a&quot; 
##  21  22 
## &quot;t&quot; &quot;t&quot;</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">vs &lt;-<span class="st"> </span><span class="kw">variableSites</span>(dolph.seqs)
vs</code></pre>
<pre><code>## $sites
## 126 DNA sequences in binary format stored in a matrix.
## 
## All sequences of same length: 41 
## 
## Labels: 4495 4496 4498 5814 5815 5816 ...
## 
## Base composition:
##     a     c     g     t 
## 0.206 0.360 0.088 0.347 
## 
## $site.freqs
##    20  32  57  92  97  99 101 104 106 109 149 150 151 205 245 248 265 269
## a   2   0   1 124   0   0   0 125 124   0   0 124   0   0   0   2   2   0
## c   0  10   0   0   7 115   6   0   0  12 112   0   2 102 114   0  31  99
## g 124   0 125   2   0   0   0   1   2   0   0   2   0   0   0 124   0   0
## t   0 116   0   0 119  11 120   0   0 114  14   0 124  24  12   0  93  27
## -   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
##   272 274 275 278 279 280 282 283 287 293 294 302 303 305 329 357 370 373
## a 123   1 123   0   0   0   0   0 125   0   0   0  78   0   0   0   0   0
## c   0 124   0  10  14   2  98  97   0  84  97 124   0   4 112 124  77   4
## g   3   0   3   0   0   0   0   0   1   0   0   0  48   0   0   0   0   0
## t   0   1   0 116 112 124  28  29   0  42  29   2   0 122  14   2  49 122
## -   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
##   390 391 392 393 394
## a 108   0   0   0   0
## c   0  27 125   1 125
## g  18   0   0   0   0
## t   0  99   1 125   1
## -   0   0   0   0   0</code></pre>
<p>Both functions take an optional set of bases to consider when evaluating whether a site is fixed or variable. For <em>fixedSites</em>, the function will only count those sites that are fixed in the listed <em>bases</em> argument. For <em>variableSites</em> the site is considered variable if it has those bases and is not fixed for them:</p>
<pre class="sourceCode r"><code class="sourceCode r">fs &lt;-<span class="st"> </span><span class="kw">fixedSites</span>(dolph.seqs, <span class="dt">bases =</span> <span class="kw">c</span>(<span class="st">&quot;c&quot;</span>, <span class="st">&quot;t&quot;</span>))
fs[<span class="dv">1</span>:<span class="dv">20</span>]</code></pre>
<pre><code>##   9  10  11  13  14  16  18  21  22  24  25  27  30  33  35  38  40  41 
## &quot;c&quot; &quot;t&quot; &quot;t&quot; &quot;t&quot; &quot;t&quot; &quot;t&quot; &quot;c&quot; &quot;t&quot; &quot;t&quot; &quot;c&quot; &quot;c&quot; &quot;c&quot; &quot;c&quot; &quot;c&quot; &quot;c&quot; &quot;t&quot; &quot;c&quot; &quot;t&quot; 
##  43  45 
## &quot;c&quot; &quot;t&quot;</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">vs &lt;-<span class="st"> </span><span class="kw">variableSites</span>(dolph.seqs, <span class="dt">bases =</span> <span class="kw">c</span>(<span class="st">&quot;c&quot;</span>, <span class="st">&quot;t&quot;</span>))
vs</code></pre>
<pre><code>## $sites
## 126 DNA sequences in binary format stored in a matrix.
## 
## All sequences of same length: 29 
## 
## Labels: 4495 4496 4498 5814 5815 5816 ...
## 
## Base composition:
##     a     c     g     t 
## 0.001 0.509 0.000 0.490 
## 
## $site.freqs
##    32  97  99 101 109 149 151 205 245 265 269 274 278 279 280 282 283 293
## c  10   7 115   6  12 112   2 102 114  31  99 124  10  14   2  98  97  84
## t 116 119  11 120 114  14 124  24  12  93  27   1 116 112 124  28  29  42
##   294 302 305 329 357 370 373 391 392 393 394
## c  97 124   4 112 124  77   4  27 125   1 125
## t  29   2 122  14   2  49 122  99   1 125   1</code></pre>
<p>There are also functions to compare bases against IUPAC ambiguity codes. One can calculate the appropriate IUPAC code for a vector of nucleotides:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">iupacCode</span>(<span class="kw">c</span>(<span class="st">&quot;c&quot;</span>, <span class="st">&quot;t&quot;</span>, <span class="st">&quot;t&quot;</span>, <span class="st">&quot;c&quot;</span>, <span class="st">&quot;c&quot;</span>))</code></pre>
<pre><code>## [1] &quot;y&quot;</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">iupacCode</span>(<span class="kw">c</span>(<span class="st">&quot;c&quot;</span>, <span class="st">&quot;t&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;c&quot;</span>, <span class="st">&quot;c&quot;</span>))</code></pre>
<pre><code>## [1] &quot;h&quot;</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">iupacCode</span>(<span class="kw">c</span>(<span class="st">&quot;g&quot;</span>, <span class="st">&quot;t&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;c&quot;</span>, <span class="st">&quot;c&quot;</span>))</code></pre>
<pre><code>## [1] &quot;n&quot;</code></pre>
<p>One can also calculate all IUPAC codes that apply to a vector of nucleotides:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">validIupacCodes</span>(<span class="kw">c</span>(<span class="st">&quot;c&quot;</span>, <span class="st">&quot;t&quot;</span>, <span class="st">&quot;t&quot;</span>, <span class="st">&quot;c&quot;</span>, <span class="st">&quot;c&quot;</span>))</code></pre>
<pre><code>## [1] &quot;y&quot; &quot;b&quot; &quot;h&quot; &quot;n&quot; &quot;x&quot; &quot;-&quot; &quot;.&quot;</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">validIupacCodes</span>(<span class="kw">c</span>(<span class="st">&quot;c&quot;</span>, <span class="st">&quot;t&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;c&quot;</span>, <span class="st">&quot;c&quot;</span>))</code></pre>
<pre><code>## [1] &quot;h&quot; &quot;n&quot; &quot;x&quot; &quot;-&quot; &quot;.&quot;</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">validIupacCodes</span>(<span class="kw">c</span>(<span class="st">&quot;g&quot;</span>, <span class="st">&quot;t&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;c&quot;</span>, <span class="st">&quot;c&quot;</span>))</code></pre>
<pre><code>## [1] &quot;n&quot; &quot;x&quot; &quot;-&quot; &quot;.&quot;</code></pre>
<p>A consensus sequence can also be easily generated:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">createConsensus</span>(dolph.seqs)</code></pre>
<pre><code>##   [1] &quot;g&quot; &quot;a&quot; &quot;a&quot; &quot;a&quot; &quot;a&quot; &quot;a&quot; &quot;-&quot; &quot;g&quot; &quot;c&quot; &quot;t&quot; &quot;t&quot; &quot;a&quot; &quot;t&quot; &quot;t&quot; &quot;g&quot; &quot;t&quot; &quot;a&quot;
##  [18] &quot;c&quot; &quot;a&quot; &quot;r&quot; &quot;t&quot; &quot;t&quot; &quot;a&quot; &quot;c&quot; &quot;c&quot; &quot;a&quot; &quot;c&quot; &quot;a&quot; &quot;a&quot; &quot;c&quot; &quot;a&quot; &quot;y&quot; &quot;c&quot; &quot;a&quot;
##  [35] &quot;c&quot; &quot;a&quot; &quot;g&quot; &quot;t&quot; &quot;a&quot; &quot;c&quot; &quot;t&quot; &quot;a&quot; &quot;c&quot; &quot;g&quot; &quot;t&quot; &quot;c&quot; &quot;a&quot; &quot;g&quot; &quot;t&quot; &quot;a&quot; &quot;t&quot;
##  [52] &quot;t&quot; &quot;a&quot; &quot;a&quot; &quot;a&quot; &quot;a&quot; &quot;r&quot; &quot;t&quot; &quot;a&quot; &quot;a&quot; &quot;t&quot; &quot;t&quot; &quot;t&quot; &quot;g&quot; &quot;t&quot; &quot;t&quot; &quot;t&quot; &quot;t&quot;
##  [69] &quot;a&quot; &quot;a&quot; &quot;a&quot; &quot;a&quot; &quot;a&quot; &quot;c&quot; &quot;a&quot; &quot;t&quot; &quot;t&quot; &quot;t&quot; &quot;t&quot; &quot;a&quot; &quot;c&quot; &quot;t&quot; &quot;g&quot; &quot;t&quot; &quot;a&quot;
##  [86] &quot;c&quot; &quot;a&quot; &quot;c&quot; &quot;a&quot; &quot;t&quot; &quot;t&quot; &quot;r&quot; &quot;c&quot; &quot;a&quot; &quot;t&quot; &quot;a&quot; &quot;y&quot; &quot;a&quot; &quot;y&quot; &quot;a&quot; &quot;y&quot; &quot;a&quot;
## [103] &quot;c&quot; &quot;r&quot; &quot;c&quot; &quot;r&quot; &quot;t&quot; &quot;g&quot; &quot;y&quot; &quot;g&quot; &quot;c&quot; &quot;a&quot; &quot;t&quot; &quot;g&quot; &quot;c&quot; &quot;t&quot; &quot;a&quot; &quot;a&quot; &quot;t&quot;
## [120] &quot;a&quot; &quot;t&quot; &quot;t&quot; &quot;t&quot; &quot;a&quot; &quot;g&quot; &quot;t&quot; &quot;c&quot; &quot;-&quot; &quot;t&quot; &quot;c&quot; &quot;t&quot; &quot;c&quot; &quot;c&quot; &quot;t&quot; &quot;t&quot; &quot;g&quot;
## [137] &quot;t&quot; &quot;a&quot; &quot;a&quot; &quot;a&quot; &quot;t&quot; &quot;a&quot; &quot;t&quot; &quot;t&quot; &quot;c&quot; &quot;a&quot; &quot;t&quot; &quot;a&quot; &quot;y&quot; &quot;r&quot; &quot;y&quot; &quot;a&quot; &quot;c&quot;
## [154] &quot;a&quot; &quot;t&quot; &quot;g&quot; &quot;c&quot; &quot;t&quot; &quot;a&quot; &quot;t&quot; &quot;g&quot; &quot;t&quot; &quot;a&quot; &quot;t&quot; &quot;t&quot; &quot;a&quot; &quot;t&quot; &quot;t&quot; &quot;g&quot; &quot;t&quot;
## [171] &quot;g&quot; &quot;c&quot; &quot;a&quot; &quot;t&quot; &quot;t&quot; &quot;c&quot; &quot;a&quot; &quot;t&quot; &quot;t&quot; &quot;t&quot; &quot;a&quot; &quot;t&quot; &quot;t&quot; &quot;t&quot; &quot;t&quot; &quot;c&quot; &quot;c&quot;
## [188] &quot;a&quot; &quot;t&quot; &quot;a&quot; &quot;c&quot; &quot;g&quot; &quot;a&quot; &quot;t&quot; &quot;a&quot; &quot;a&quot; &quot;g&quot; &quot;t&quot; &quot;t&quot; &quot;a&quot; &quot;a&quot; &quot;a&quot; &quot;g&quot; &quot;c&quot;
## [205] &quot;y&quot; &quot;c&quot; &quot;g&quot; &quot;t&quot; &quot;a&quot; &quot;t&quot; &quot;t&quot; &quot;a&quot; &quot;a&quot; &quot;t&quot; &quot;t&quot; &quot;a&quot; &quot;t&quot; &quot;c&quot; &quot;a&quot; &quot;t&quot; &quot;t&quot;
## [222] &quot;a&quot; &quot;a&quot; &quot;t&quot; &quot;t&quot; &quot;t&quot; &quot;t&quot; &quot;a&quot; &quot;c&quot; &quot;a&quot; &quot;t&quot; &quot;a&quot; &quot;t&quot; &quot;t&quot; &quot;a&quot; &quot;c&quot; &quot;a&quot; &quot;t&quot;
## [239] &quot;a&quot; &quot;a&quot; &quot;t&quot; &quot;a&quot; &quot;t&quot; &quot;g&quot; &quot;y&quot; &quot;a&quot; &quot;t&quot; &quot;r&quot; &quot;c&quot; &quot;t&quot; &quot;c&quot; &quot;t&quot; &quot;t&quot; &quot;a&quot; &quot;c&quot;
## [256] &quot;a&quot; &quot;t&quot; &quot;a&quot; &quot;t&quot; &quot;t&quot; &quot;a&quot; &quot;t&quot; &quot;a&quot; &quot;t&quot; &quot;h&quot; &quot;t&quot; &quot;c&quot; &quot;c&quot; &quot;y&quot; &quot;c&quot; &quot;t&quot; &quot;r&quot;
## [273] &quot;t&quot; &quot;h&quot; &quot;r&quot; &quot;a&quot; &quot;t&quot; &quot;y&quot; &quot;y&quot; &quot;y&quot; &quot;a&quot; &quot;y&quot; &quot;y&quot; &quot;t&quot; &quot;c&quot; &quot;c&quot; &quot;r&quot; &quot;t&quot; &quot;t&quot;
## [290] &quot;a&quot; &quot;t&quot; &quot;a&quot; &quot;y&quot; &quot;y&quot; &quot;c&quot; &quot;t&quot; &quot;a&quot; &quot;t&quot; &quot;g&quot; &quot;g&quot; &quot;t&quot; &quot;y&quot; &quot;r&quot; &quot;c&quot; &quot;y&quot; &quot;c&quot;
## [307] &quot;c&quot; &quot;a&quot; &quot;t&quot; &quot;t&quot; &quot;a&quot; &quot;g&quot; &quot;a&quot; &quot;t&quot; &quot;c&quot; &quot;a&quot; &quot;c&quot; &quot;g&quot; &quot;a&quot; &quot;g&quot; &quot;c&quot; &quot;t&quot; &quot;t&quot;
## [324] &quot;a&quot; &quot;a&quot; &quot;t&quot; &quot;c&quot; &quot;a&quot; &quot;y&quot; &quot;c&quot; &quot;a&quot; &quot;t&quot; &quot;g&quot; &quot;c&quot; &quot;c&quot; &quot;g&quot; &quot;c&quot; &quot;g&quot; &quot;t&quot; &quot;g&quot;
## [341] &quot;a&quot; &quot;a&quot; &quot;a&quot; &quot;c&quot; &quot;c&quot; &quot;a&quot; &quot;g&quot; &quot;c&quot; &quot;a&quot; &quot;a&quot; &quot;c&quot; &quot;c&quot; &quot;c&quot; &quot;g&quot; &quot;c&quot; &quot;t&quot; &quot;y&quot;
## [358] &quot;g&quot; &quot;g&quot; &quot;c&quot; &quot;a&quot; &quot;g&quot; &quot;g&quot; &quot;g&quot; &quot;a&quot; &quot;t&quot; &quot;c&quot; &quot;c&quot; &quot;c&quot; &quot;y&quot; &quot;c&quot; &quot;t&quot; &quot;y&quot; &quot;c&quot;
## [375] &quot;t&quot; &quot;c&quot; &quot;g&quot; &quot;c&quot; &quot;a&quot; &quot;c&quot; &quot;c&quot; &quot;g&quot; &quot;g&quot; &quot;g&quot; &quot;c&quot; &quot;c&quot; &quot;c&quot; &quot;a&quot; &quot;t&quot; &quot;r&quot; &quot;y&quot;
## [392] &quot;y&quot; &quot;y&quot; &quot;y&quot; &quot;g&quot; &quot;t&quot; &quot;g&quot; &quot;g&quot; &quot;g&quot; &quot;g&quot; &quot;g&quot; &quot;t&quot;</code></pre>
<p>Nucleotide diversity for each site is calculaed with:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">nucleotideDiversity</span>(dolph.seqs)</code></pre>
<pre><code>##     1     2     3     4     5     6     7     8     9    10    11    12 
## 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 
##    13    14    15    16    17    18    19    20    21    22    23    24 
## 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.031 0.000 0.000 0.000 0.000 
##    25    26    27    28    29    30    31    32    33    34    35    36 
## 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.147 0.000 0.000 0.000 0.000 
##    37    38    39    40    41    42    43    44    45    46    47    48 
## 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 
##    49    50    51    52    53    54    55    56    57    58    59    60 
## 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.016 0.000 0.000 0.000 
##    61    62    63    64    65    66    67    68    69    70    71    72 
## 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 
##    73    74    75    76    77    78    79    80    81    82    83    84 
## 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 
##    85    86    87    88    89    90    91    92    93    94    95    96 
## 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.031 0.000 0.000 0.000 0.000 
##    97    98    99   100   101   102   103   104   105   106   107   108 
## 0.106 0.000 0.161 0.000 0.091 0.000 0.000 0.016 0.000 0.031 0.000 0.000 
##   109   110   111   112   113   114   115   116   117   118   119   120 
## 0.174 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 
##   121   122   123   124   125   126   127   128   129   130   131   132 
## 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 
##   133   134   135   136   137   138   139   140   141   142   143   144 
## 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 
##   145   146   147   148   149   150   151   152   153   154   155   156 
## 0.000 0.000 0.000 0.000 0.199 0.031 0.031 0.000 0.000 0.000 0.000 0.000 
##   157   158   159   160   161   162   163   164   165   166   167   168 
## 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 
##   169   170   171   172   173   174   175   176   177   178   179   180 
## 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 
##   181   182   183   184   185   186   187   188   189   190   191   192 
## 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 
##   193   194   195   196   197   198   199   200   201   202   203   204 
## 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 
##   205   206   207   208   209   210   211   212   213   214   215   216 
## 0.311 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 
##   217   218   219   220   221   222   223   224   225   226   227   228 
## 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 
##   229   230   231   232   233   234   235   236   237   238   239   240 
## 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 
##   241   242   243   244   245   246   247   248   249   250   251   252 
## 0.000 0.000 0.000 0.000 0.174 0.000 0.000 0.031 0.000 0.000 0.000 0.000 
##   253   254   255   256   257   258   259   260   261   262   263   264 
## 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 
##   265   266   267   268   269   270   271   272   273   274   275   276 
## 0.398 0.000 0.000 0.000 0.339 0.000 0.000 0.047 0.000 0.032 0.047 0.000 
##   277   278   279   280   281   282   283   284   285   286   287   288 
## 0.000 0.147 0.199 0.031 0.000 0.348 0.357 0.000 0.000 0.000 0.016 0.000 
##   289   290   291   292   293   294   295   296   297   298   299   300 
## 0.000 0.000 0.000 0.000 0.448 0.357 0.000 0.000 0.000 0.000 0.000 0.000 
##   301   302   303   304   305   306   307   308   309   310   311   312 
## 0.000 0.031 0.475 0.000 0.062 0.000 0.000 0.000 0.000 0.000 0.000 0.000 
##   313   314   315   316   317   318   319   320   321   322   323   324 
## 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 
##   325   326   327   328   329   330   331   332   333   334   335   336 
## 0.000 0.000 0.000 0.000 0.199 0.000 0.000 0.000 0.000 0.000 0.000 0.000 
##   337   338   339   340   341   342   343   344   345   346   347   348 
## 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 
##   349   350   351   352   353   354   355   356   357   358   359   360 
## 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.031 0.000 0.000 0.000 
##   361   362   363   364   365   366   367   368   369   370   371   372 
## 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.479 0.000 0.000 
##   373   374   375   376   377   378   379   380   381   382   383   384 
## 0.062 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 
##   385   386   387   388   389   390   391   392   393   394   395   396 
## 0.000 0.000 0.000 0.000 0.000 0.247 0.339 0.016 0.016 0.016 0.000 0.000 
##   397   398   399   400   401   402 
## 0.000 0.000 0.000 0.000 0.000 0.000</code></pre>
<p>For a stratified <em>gtypes</em> object, one can calculate net nucleotide divergence (Nei’s dA), and distributions of between- and within-strata divergence:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># create gtypes</span>
<span class="kw">data</span>(dolph.seqs)
<span class="kw">data</span>(dolph.strata)
dloop.haps &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="dt">dLoop =</span> dolph.strata$id)
<span class="kw">rownames</span>(dloop.haps) &lt;-<span class="st"> </span>dolph.strata$id
strata.schemes &lt;-<span class="st"> </span>dolph.strata[, <span class="kw">c</span>(<span class="st">&quot;broad&quot;</span>, <span class="st">&quot;fine&quot;</span>)]
<span class="kw">rownames</span>(strata.schemes) &lt;-<span class="st"> </span>dolph.strata$id
dloop &lt;-<span class="st"> </span><span class="kw">new</span>(<span class="st">&quot;gtypes&quot;</span>, <span class="dt">gen.data =</span> dloop.haps, <span class="dt">ploidy =</span> <span class="dv">1</span>,
             <span class="dt">schemes =</span> strata.schemes, <span class="dt">sequences =</span> dolph.seqs,
             <span class="dt">strata =</span> <span class="st">&quot;fine&quot;</span>)
dloop &lt;-<span class="st"> </span><span class="kw">labelHaplotypes</span>(dloop, <span class="st">&quot;Hap.&quot;</span>)$gtypes

<span class="co"># calculate divergence</span>
<span class="kw">nucleotideDivergence</span>(dloop)</code></pre>
<pre><code>## $dLoop
## $dLoop$within
##                  mean pct.0 pct.0.025 pct.0.5 pct.0.975 pct.1
## Coastal        0.0052     0         0   0.005     0.010 0.010
## Offshore.North 0.0234     0         0   0.023     0.039 0.053
## Offshore.South 0.0192     0         0   0.018     0.040 0.044
## 
## $dLoop$between
##         strata.1       strata.2     dA  mean  pct.0 pct.0.025 pct.0.5
## 1        Coastal Offshore.North 0.0063 0.021 0.0000    0.0050   0.020
## 2        Coastal Offshore.South 0.0066 0.019 0.0076    0.0076   0.018
## 3 Offshore.North Offshore.South 0.0014 0.023 0.0000    0.0000   0.023
##   pct.0.975 pct.1
## 1     0.034 0.039
## 2     0.034 0.039
## 3     0.042 0.050</code></pre>
<p>For stratified <em>gtypes</em>, one can also identify fixed differences between strata:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">fixedDifferences</span>(dloop)</code></pre>
<pre><code>## $sites
## $sites$`Coastal v. Offshore.North`
##               
## Coastal       
## Offshore.North
## 
## $sites$`Coastal v. Offshore.South`
##               
## Coastal       
## Offshore.South
## 
## $sites$`Offshore.North v. Offshore.South`
##               
## Offshore.North
## Offshore.South
## 
## 
## $num.fixed
##         strata.1       strata.2 num.fixed
## 1        Coastal Offshore.North         0
## 2        Coastal Offshore.South         0
## 3 Offshore.North Offshore.South         0</code></pre>
<p>Two functions have been provided to select a subset of representative sequences. The first selects the most distant sequences in order to capture the full distribution of variation. For example:</p>
<pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">as.DNAbin</span>(dolph.seqs)
<span class="kw">mostDistantSequences</span>(x, <span class="dt">num.seqs =</span> <span class="dv">5</span>)</code></pre>
<pre><code>## [1] &quot;74962&quot; &quot;6290&quot;  &quot;74963&quot; &quot;18652&quot; &quot;50746&quot;</code></pre>
<p>The other function selects the most representative sequences by first clustering the sequences and selecting the sequences closest to the center of each cluster:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mostRepresentativeSequences</span>(x, <span class="dt">num.seqs =</span> <span class="dv">5</span>)</code></pre>
<pre><code>## [1] &quot;6153&quot;  &quot;18655&quot; &quot;74964&quot; &quot;78051&quot; &quot;78054&quot;</code></pre>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
